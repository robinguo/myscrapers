import requests
import re
from bs4 import BeautifulSoup

# codes = ['000009']
codes = ['000009','000203','000210','000300','000324','000331','000366','000379','000380','000424','000434','000439','000464','000475','000483','000493','000505','000509','000528','000533','000540','000542','000548','000559','000560','000569','000576','000588','000600','000604','000615','000626','000638','000644','000647','000657','000658','000659','000660','000661','000662','000677','000678','000681','000683','000699','000701','000704','000709','000710','000712','000721','000724','000726','000730','000734','000738','000741','000748','000759','000771','000773','000785','000789','000797','000816','000836','000837','000847','000855','000860','000871','000882','000901','000903','000907','000912','000917','000981','001006','001077','001096','001101','001175','001232','001234','001308','001386','001401','001477','001526','001624','001666','001697','001812','001820','001826','001842','001870','001894','001909','001916','001925','001929','001931','001937','001973','001981','001987','001991','002077','002184','002195','002200','002247','002260','002298','002318','002324','002646','002672','002679','002709','002748','002759','002788','002847','002852','002883','002889','002890','002894','002912','002918','002957','003003','003022','003034','003042','003043','003171','003206','003228','003246','003252','003316','003363','003388','003391','003398','003402','003422','003465','003467','003473','003474','003478','003479','003482','003483','003515','003534','003536','003537','003585','003588','003678','003711','003752','003874','003968','003969','003997','004039','004072','004077','004097','004120','004121','004133','004151','004173','004178','004185','004210','004216','004261','004285','004330','004368','004372','004399','004449','004493','004545','004699','004717','004770','004786','004849','004860','004861','004865','004896','004903','004967','004970','004972','004983','004985','005016','005056','005134','005148','005150','007708','007868','020007','020031','040003','040038','050003','070008','070028','080011','090005','090022','100025','110006','121011','150005','150988','160606','161608','161622','162206','163802','166014','180008','200003','202301','202307','210012','213009','217004','240006','253050','260102','270004','288101','290001','310338','320002','340005','350004','360003','370010','392001','400005','410002','420006','460006','482002','519505','519508','519509','519511','519513','519518','519566','519588','519999','530002','540011','550010','560001','583001','620010','630012','660007','675031','675061','675071','690010','710501','730003','740601','750006']
urlprefix = 'http://fund.eastmoney.com/'

for c in codes:
    url = urlprefix + c + ".html"
    response = requests.get(url)
    soup = BeautifulSoup(response.content, 'html.parser')
    # 基金規模
    info = soup.select('div.infoOfFund table tr td:nth-of-type(2)')[0]
    scale = re.findall(r'[0-9]+\.[0-9]+', info.text)[0]
    # 收益率
    data = soup.select('div.dataOfFund')[1]
    perf = re.findall(r'[0-9]+\.[0-9]+%', data.text)
    # 申購費率、申購時長、贖回費率、贖回時長
    # 機構投資者占比
    print(f'{c},{scale},{",".join(perf)}')
